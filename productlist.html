<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="user-scalable=no,initial-scale=1,width=device-width" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script type="text/javascript" src="js/dave.js"></script>
    <title>HomeCenter</title>
</head>

<body>
    <!-- --------------- navbar ----------- -->
    <nav>
        <div class="topnav">
            <div class="logo">
                <a href="index.html"><img src="./images/logo-homecentre.svg" alt=""></a>
            </div>
            <div class="search-container">
                <div class="search_form" id="searchForm">
                    <input type="text" name="search" placeholder="Search..">
                    <button type="submit" id="searchButton"><i class="fa fa-search"></i></button>
                </div>
            </div>
            <a href="#">
                <p>Enquiry List <i style="font-size:24px" class="fa" id="shopping-bag">&#xf290;</i></p>
            </a>
        </div>
    </nav>
    <hr>
    <!-------------------------------PRODUCT LIST AREA--------------------------------------->
        <div class="pg_container">
        <div class="price_filter">
            <p>Filters</p>
            <form action="">
                <div class="selectdiv ">
                <label for="Price">
                <select name="Price" id="pricesortlist" class="pricedropdown">
                    <option value="" disabled selected hidden>Price</option>
                    <option value="0 - 299">0 - 299</option>
                    <option value="300 - 499">300 - 499</option>
                    <option value="500 - 999">500 - 999</option>
                    <option value="1000 - 1499">1000 - 1499</option>
                    <option value="1500 - 1999">1500 - 1999</option>
                    <option value="2000 - ">2000 & Above</option>
                </select>
                </label>
                </div>
                    <p class="clear">Clear all filters</p>
            </form>
        </div>
        <hr id="hr">
        <div class="product_cont">
            <!-- PRODUCT QUICK VIEW POPUP -->
            <div class="product_pop_bg">
            </div>
                <div class="sec_pg_cont" id="quickview">
                    <ul class="sec_pg_cont_ul">
                        <li class="sec_pg_ul_li">
                            <ol class="sec_pg_ol">
                                <li class="sec_pg_img_li"><div><img id="imgBox" class="sec_pg_img" src="./images/prod1.jpg" alt=""></div></li>
                                <li class="sec_pg_img_li">
                                    <ul class="sec_pg_img_ul">
                                        
                                    </ul>
                                </li>
                            </ol>
                        </li>
                        <li class="sec_pg_ul_li det-l2">
                            <ol class="sec_pg_ol">
                                <li class="sec_pg_ol_li1"><p id="prod_pg_pop_tit">Dummy Title</p></li>
                                <li class="sec_pg_ol_li2"><p id="prod_pg_pop_price">000</p></li>
                                <li class="sec_pg_ol_li3">
                                    <ul>
                                        <li><input class="sec_pg_ol_input" type="text" id="product_quanity_add" placeholder="Qty"></li>
                                        <li><p>In Stock</p></li>
                                    </ul>
                                </li>
                                <hr class="pr_detail_hr">
                                <li class="sec_pg_ol_li4"><button class="pr_detail_btn" id="add_enq_list">Add to Enquiry List</button></li>
                                <hr class="pr_detail_hr">
                                <li class="sec_pg_ol_li5"><a href="fifthpage.html" id="product_fullDetails">See Full Details</a></li>
                            </ol>
                        </li>
                        <li><span class="close" id="closepopup">&times;</span></li>
                    </ul>
                </div>            
            <!--PRODUCT LIST -->
            <ul class="product_cont_ul">

            </ul>
        </div>
        </div>
            <!-- ------------------------ 2nd strip section --------------- -->
    <section class="container">
        <footer>
            <hr>
            <div class="firstfoot-left">
                <div class="firstfoot_in_cont">
                    <a href="#">
                        <div class="details">
                            <div class="icon">
                                <i class="fa fa-phone"></i>
                            </div>
                            <span class="txt">
                                <p class="uptxt">Talk to us</p>
                                <p class='lowtxt'>1800-212-7500</p>
                            </span>
                        </div>
                    </a>
                    <a href="#">
                        <div class="details">
                            <div class="icon">
                                <i class="fa fa-question-circle" ></i>
                            </div>
                            <div class="txt">
                                <p class="uptxt">HomeCentre</p>
                                <p class='lowtxt'>homecentre.in/help</p>
                            </div>
                        </div>
                    </a>
                    <a href="#">
                        <div class="details">
                            <div class="icon">
                                <i class="fa fa-envelope"></i>
                            </div>
                            <div class="txt">
                                <p class="uptxt">Write to us</p>
                                <p class='lowtxt'>help@homecentre.in</p>
                            </div>
                        </div>
                    </a>
                </div>
                <!-- ---- social media icons  ---- -->
                <div class="social-icon">
                    <div class="details">
                        <div class="social">
                            <a href="https://www.facebook.com/HomeCentreIndia/" class="fa fa-facebook"></a>
                        </div>
                    </div>
                    <div class="details">
                        <div class="social">
                            <a href="https://twitter.com/homecentreindia" class="fa fa-twitter"></a>
                        </div>
                    </div>
                    <div class="details">
                        <div class="social" >
                            <a href="https://www.instagram.com/homecentreindia/" class="fa fa-instagram"></a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- ---------------------------- footer --------------------- -->
            <hr>
            <div class="Mainfooter">
                <div class="firstfoot1">
                    <a href=""><img src="./images/footer-logo.svg" alt=""></a>
                </div>
                <div class="txt-foot">
                    <p>&#9400; 2020 RNA Intellectual Property Limited.</p>
                    <p>TERMS & CONDITION - <a href="https://www.homecentre.in/in/en/privacypolicy" class="pnp">Privacy Policy</a></p>
                </div>
            </div>
        </footer>
    </section>
    <script type="text/javascript">
        //This Section get executed only when customer has provided pincode
        if(getCookie("pincode")){
            console.log("Pincode Recieved");
            console.log("Customer is patched with pincode");
            const pincode = getCookie("pincode");
            get_products({"available_pincodes": pincode, "page_size":10,"page_number":1}, function(data) {
                var return_size = data['data'].length;
                if(return_size > 0){
                    for(var i = 0; i < return_size; i++){
                        $(".product_cont_ul").append(`
                            <li class="product_cont_ul_li" data-pid="${data['data'][i]['product_id']}">
                                <ol class="product_solo_cont">
                                    <li>
                                        <div class="img_container">
                                            <img class="product_img" src="${data['data'][i]['image_1']}" alt="">
                                            <button class="btn-2">Quick View</button>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="small_img_container"><img class="small_img" src="${data['data'][i]['image_1']}" alt=""></div>
                                    </li>
                                    <li>
                                        <h4 class="product_price">â‚¹ ${data['data'][i]['selling_price']}</h4>
                                    </li>
                                    <li>
                                        <h4 class="product_heading">${data['data'][i]['name']}</h4>
                                    </li>
                                </ol>
                            </li>
                        `);                                   
                    }
                }else{
                    $(".product_cont_ul").append(`<p>Your Pincode is not Serviceable for Corporate Gifting Orders.</p>`);
                }
            })
        }else{
            //####### This section gets executed when customer doesn't enter any pincode and get direct access to product page
            get_products({"page_size":10, "page_number":1},function(data){
                console.log("Page Loading Product without pinocde input");
                var return_size = data['data'].length;
                for(var i = 0; i < return_size; i++){
                    $(".product_cont_ul").append(`
                        <li class="product_cont_ul_li" data-pid="${data['data'][i]['product_id']}">
                            <ol class="product_solo_cont">
                                <li>
                                    <div class="img_container">
                                        <img class="product_img" src="${data['data'][i]['image_1']}" alt="">
                                        <button class="btn-2">Quick View</button>
                                    </div>
                                </li>
                                <li>
                                    <div class="small_img_container"><img class="small_img" src="${data['data'][i]['image_1']}" alt=""></div>
                                </li>
                                <li>
                                    <h4 class="product_price">â‚¹ ${data['data'][i]['selling_price']}</h4>
                                </li>
                                <li>
                                    <h4 class="product_heading">${data['data'][i]['name']}</h4>
                                </li>
                            </ol>
                        </li>
                    `);                                   
                }
            });
        }
        /*PRODUCT Page Price Sorting*/
            $("#pricesortlist").on("change", function () {
                var sort_price = $(this).find(":selected").val();
                sort_price = sort_price.replace("-",",");
                sort_price = sort_price.split(" ").join("");
                console.log("User tried to sort product according to price"+sort_price);
                get_products({"price":sort_price,"page_size":10, "page_number":1}, function(data){
                    var return_size = data['data'].length;
                    $(".product_cont_ul").html("");
                    for(var i = 0; i < return_size; i++){
                            $(".product_cont_ul").append(`
                            <li class="product_cont_ul_li" data-pid="${data['data'][i]['product_id']}">
                                <ol class="product_solo_cont">
                                    <li>
                                        <div class="img_container">
                                            <img class="product_img" src="${data['data'][i]['image_1']}" alt="">
                                            <button class="btn-2">Quick View</button>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="small_img_container"><img class="small_img" src="${data['data'][i]['image_1']}" alt=""></div>
                                    </li>
                                    <li>
                                        <h4 class="product_price">â‚¹ ${data['data'][i]['selling_price']}</h4>
                                    </li>
                                    <li>
                                        <h4 class="product_heading">${data['data'][i]['name']}</h4>
                                    </li>
                                </ol>
                            </li>
                        `);
                    }
                });
            });
        /*PRODUCT Page Price Sort Selection Clear*/
            $(".clear").on("click", function(){
                $("#pricesortlist").val($("#pricesortlist option:first").val());
                var check = $("#pricesortlist").prop("selected",false); 
                get_products({"page_size":10, "page_number":1},function(data){
                    console.log("user cleared the price sorting");
                    var return_size = data['data'].length;
                    $(".product_cont_ul").html("");
                    for(var i = 0; i < return_size; i++){
                        $(".product_cont_ul").append(`
                            <li class="product_cont_ul_li" data-pid="${data['data'][i]['product_id']}">
                                <ol class="product_solo_cont">
                                    <li>
                                        <div class="img_container">
                                            <img class="product_img" src="${data['data'][i]['image_1']}" alt="">
                                            <button class="btn-2">Quick View</button>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="small_img_container"><img class="small_img" src="${data['data'][i]['image_1']}" alt=""></div>
                                    </li>
                                    <li>
                                        <h4 class="product_price">â‚¹ ${data['data'][i]['selling_price']}</h4>
                                    </li>
                                    <li>
                                        <h4 class="product_heading">${data['data'][i]['name']}</h4>
                                    </li>
                                </ol>
                            </li>
                        `);                                   
                    }
                });                
            })
        /*PRODUCT POPUP*/
            $(document.body).on("click", '.product_cont_ul_li', function(){
                var pid = $(this).attr("data-pid");
                var pro_price = $(this).find(".product_price").text();
                var pro_title = $(this).find(".product_heading").text();
                var pro_image = $(this).find(".product_img").attr("src");

                $(".product_pop_bg").css("display", "block");
                $(".sec_pg_cont").css("display", "block");
                $('body').css("overflow","hidden");

                $("#prod_pg_pop_tit").text(pro_title);
                $("#prod_pg_pop_price").text(`${pro_price}`);
                $("#imgBox").attr("src", pro_image);
                console.log("User has quick viewed");
                ajaxRequestWithData(`/object/product/${pid}`,"GET",{},function(data){
                    $('.sec_pg_img_ul').html(`
                        <li><div class="product_popup_smallimg_container"><img class="sec_pg_small_img" src="${data["image_1"]}" alt=""></div></li>
                        <li><div class="product_popup_smallimg_container"><img class="sec_pg_small_img" src="${data["image_2"]}" alt=""></div></li>
                        <li><div class="product_popup_smallimg_container"><img class="sec_pg_small_img" src="${data["image_3"]}" alt=""></div></li>
                        <li><div class="product_popup_smallimg_container"><img class="sec_pg_small_img" src="${data["image_4"]}" alt=""></div></li>
                        <li><div class="product_popup_smallimg_container"><img class="sec_pg_small_img" src="${data["image_5"]}" alt=""></div></li>
                    `);
                });
                console.log(pid);
                create_product_enquiry(pid,"1","viewed",function(data){console.log(data)});
                $("#product_fullDetails").click(function(){
                    setCookie("product_id",pid);
                });
                //popup enquiry button
                $("#add_enq_list").on("click", function(){
                    var product_quanityadd = $("#product_quanity_add").val();
                    if(product_quanityadd > 0){
                        create_product_enquiry(pid,product_quanityadd,"enquired",function(data){
                            $(".product_pop_bg").css("display","none");
                            $(".sec_pg_cont").css("display","none");
                            
                            console.log("Enquiry Added To List");
                            console.log(data);
                        });
                    }else{
                        console.log("no quanity added");
                    }
                });
            });
        //PRODUCT POUP CLOSE
            $("#closepopup, .product_pop_bg").on("click", function(){
                $(".product_pop_bg").css("display","none");
                $(".sec_pg_cont").css("display", "none");
                $("body").css("overflow","auto");
            });
        /*PRODUCT POPUP Image Toogle*/
            $(document.body).on("click", '.product_popup_smallimg_container', function(){
               $("#imgBox").attr('src', $(this).children("img").attr("src"));
            });

            //########## SEARCH PRODUCT ######################
            $("#searchButton").click(function(e){
                var search_term = $("#searchForm input[type='text']").val();
                console.log("User Searched For: "+search_term);
                get_products({"keywords": ~search_term}, function(data) {
                    console.log(data);
                    var return_size = data['data'].length;
                    $(".product_cont_ul").html("");
                    for(var i = 0; i < return_size; i++){
                        $(".product_cont_ul").append(`
                            <li class="product_cont_ul_li" data-pid="${data['data'][i]['product_id']}">
                                <ol class="product_solo_cont">
                                    <li>
                                        <div class="img_container">
                                            <img class="product_img" src="${data['data'][i]['image_1']}" alt="">
                                            <button class="btn-2">Quick View</button>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="small_img_container"><img class="small_img" src="${data['data'][i]['image_1']}" alt=""></div>
                                    </li>
                                    <li>
                                        <h4 class="product_price">â‚¹ ${data['data'][i]['selling_price']}</h4>
                                    </li>
                                    <li>
                                        <h4 class="product_heading">${data['data'][i]['name']}</h4>
                                    </li>
                                </ol>
                            </li>
                        `);                                   
                    }                   
                });
            });

            //####### Product Spec Page Search
            if(getCookie("pro_specpg_search")){
                var search_term = getCookie("pro_specpg_search");
                console.log("User Searched For: "+search_term);
                get_products({"keywords": ~search_term}, function(data) {
                    console.log(data);
                    var return_size = data['data'].length;
                    $(".product_cont_ul").html("");
                    for(var i = 0; i < return_size; i++){
                        $(".product_cont_ul").append(`
                            <li class="product_cont_ul_li" data-pid="${data['data'][i]['product_id']}">
                                <ol class="product_solo_cont">
                                    <li>
                                        <div class="img_container">
                                            <img class="product_img" src="${data['data'][i]['image_1']}" alt="">
                                            <button class="btn-2">Quick View</button>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="small_img_container"><img class="small_img" src="${data['data'][i]['image_1']}" alt=""></div>
                                    </li>
                                    <li>
                                        <h4 class="product_price">â‚¹ ${data['data'][i]['selling_price']}</h4>
                                    </li>
                                    <li>
                                        <h4 class="product_heading">${data['data'][i]['name']}</h4>
                                    </li>
                                </ol>
                            </li>
                        `);                                   
                    }
                    window.localStorage.removeItem("pro_specpg_search");                 
                });                
            }
    </script>
</body>

</html>